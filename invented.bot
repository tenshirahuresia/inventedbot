javascript:(async()=>{try{   const studioNum = prompt("招待するスタジオのIDを入力してください（例：123456789）:");   if(!studioNum){alert("キャンセルされました");return;}   const user = prompt("フォロワーを取得するユーザー名を入力してください:");   if(!user){alert("キャンセルされました");return;}    document.body.innerHTML="<div id='console' style='white-space:pre-wrap;color:white;background:black;padding:8px;font-family:monospace;font-size:13px'></div>";   const log=t=>document.getElementById("console").textContent+=t+"\n";   log("スタジオID: "+studioNum);   log("ユーザー: "+user);   log("開始します…（503回避のためディレイを3秒に設定）");    let offset=0, total=0, limit=40;   const csrftoken=document.cookie.match(/scratchcsrftoken=([^;]+)/)?.[1];   if(!csrftoken){alert("CSRFトークンが見つかりません。Scratchにログインした状態で実行してください。");return;}    while(true){     const res=await fetch(`https://api.scratch.mit.edu/users/${encodeURIComponent(user)}/followers?offset=${offset}&limit=${limit}`);     if(!res.ok){log("フォロワー取得終了: "+res.status);break;}     const followers=await res.json();     const names=followers.map(f => f.username);     if(names.length===0){log("これ以上のフォロワーはいません。");break;}     log(`--- offset ${offset} (${names.length}人) ---`);     for(const name of names){       try{         let retries = 0;         let success = false;         while (retries < 3 && !success) {           const r=await fetch(`https://scratch.mit.edu/site-api/users/curators-in/${studioNum}/invite_curator/?usernames=${encodeURIComponent(name)}`,{             method:"PUT",             headers:{               "X-CSRFToken":csrftoken,               "X-Requested-With":"XMLHttpRequest"             },             credentials:"include"           });           if (r.ok) {             success = true;             log((++total)+": "+name+" → ✅成功");           } else if (r.status === 503) {             retries++;             log((total)+": "+name+" → ⚠️503検知 (リトライ"+retries+"/3, 30秒待機)");             await new Promise(s=>setTimeout(s,30000)); // 30秒待機           } else {             log((total)+": "+name+" → ❌失敗 ("+r.status+")");             break;           }         }         if (!success) {           log((total)+": "+name+" → ❌リトライ失敗");         }         await new Promise(s=>setTimeout(s,1)); // 3秒ディレイ（リトライ後も）       }catch(e){log("⚠️エラー:"+e.message);}     }     offset += limit;     if (names.length < limit) {log("これ以上のフォロワーはいません。");break;}   }   log("完了！"); }catch(e){alert("エラー: "+e.message);console.error(e);}})();
